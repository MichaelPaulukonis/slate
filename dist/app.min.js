!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("config/share")):"function"==typeof define&&define.amd?define(["config/share"],t):t(e.config)}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),h=Backbone,d=h.Model,p=function(e){var o=function(){t(this,o),null!=e&&e.apply(this,arguments)};return n(o,e),f(o,[{key:"defaults",value:function(){return{bgColor:"#018790",textColor:"#fff",font:"Georgia, serif",text:"Generate your text here",width:400,height:400,fontHeight:35,delay:200}}}]),o}(d),v=p,g=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),y=function(e,t,n){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:SlateConfigView__get(r,t,n)}if("value"in o)return o.value;var i=o.get;return void 0===i?void 0:i.call(n)},b=Backbone,m=b.View,w=function(e){var t=function(e){o(this,t),_.defaults(e,{events:{"change .text-color":"setTextColor","change .bg-color":"setBgColor","keyup .height":"setFontHeight","keyup .text":"setText","keyup .delay":"setDelay","keyup .family":"setFontFamily"}}),y(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.$(".text-color").val(this.model.get("textColor")),this.$(".bg-color").val(this.model.get("bgColor"))};return r(t,e),g(t,[{key:"initialize",value:function(){this._setDebouncedText=_.debounce(_.bind(this.setDebouncedText,this),300)}},{key:"setDebouncedText",value:function(e){this.model.set({text:e})}},{key:"setDelay",value:function(e){this.model.set({delay:parseInt($(e.target).val(),10)})}},{key:"setText",value:function(e){var t=$(e.target).val();this._setDebouncedText(t)}},{key:"setFontHeight",value:function(e){this.model.set({fontHeight:parseInt($(e.target).val(),10)})}},{key:"setTextColor",value:function(e){this.model.set({textColor:"#"+$(e.target).val()})}},{key:"setBgColor",value:function(e){this.model.set({bgColor:"#"+$(e.target).val()})}},{key:"setFontFamily",value:function(e){this.model.set({font:$(e.target).val().trim()})}},{key:"setAttributes",value:function(e){var t=$('[name="text"]').val();this.model.set({text:t})}}]),t}(m),x=w,k={setFont:function(e){var t=this.fontHeight*this.scale+"px";e.font=t+"/"+t+" "+this.font},createDummy:function(){var e=document.createElement("canvas");return e.width=this.width*this.scale,e.height=this.height*this.scale,e.getContext("2d")},drawBackground:function(e){var t=e.canvas.width,n=e.canvas.height;e.fillStyle=this.bgColor,e.fillRect(0,0,t,n)},drawText:function(e,t){var n=e.canvas.width/2,o=e.canvas.height/2;e.textAlign="center",e.textBaseline="middle",e.fillStyle=this.textColor,e.fillText(t,n,o)},drawDummy:function(e,t){var n=e.canvas.width,o=e.canvas.height;e.drawImage(t.canvas,0,0,n,o)},getCanvas:function(e){var t=document.createElement("canvas");return t.width=this.width,t.height=this.height,t},setProperties:function(e){this.bgColor=e.bgColor,this.height=e.height,this.width=e.width,this.text=e.text||"",this.textColor=e.textColor,this.delay=e.delay||350,this.fontHeight=e.fontHeight||40,this.font=e.font||"Georgia, serif",this.scale=2},render:function(e){var t=this,n=t.getCanvas().getContext("2d"),o=t.createDummy(),r=t.getGifCreator(e);t.setFont(o);for(var i=this.text.trim().split(" "),a=0,l=i.length;l>a;a++)t.drawBackground(o),t.drawText(o,i[a]),t.drawDummy(n,o),r.addFrame(n,{copy:!0,delay:t.delay});t.drawBackground(o),t.drawDummy(n,o),r.addFrame(n,{copy:!0,delay:2*t.delay}),r.render()},getGifCreator:function(e){var t=this,n=new GIF({workers:2,quality:10,width:t.width,height:t.height});return n.on("finished",function(t,n){var o=btoa(String.fromCharCode.apply(null,n));e(null,o)}),n}},C=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),O=function(e,t,n){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:SlateView__get(r,t,n)}if("value"in o)return o.value;var i=o.get;return void 0===i?void 0:i.call(n)},j=Backbone,T=j.View,P=function(e){var t=function(e){i(this,t),O(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.listenTo(this.model,"change",this.render)};return a(t,e),C(t,[{key:"render",value:function(){k.setProperties(this.model.toJSON()),k.render(function(e,t){var n=document.getElementById("result");n.src="data:image/gif;base64,"+t,localStorage.dataBase64=t})}}]),t}(T),S=P,D=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),B=function(e,t,n){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:ShareView__get(r,t,n)}if("value"in o)return o.value;var i=o.get;return void 0===i?void 0:i.call(n)},E=Backbone,V=E.View,F='     <a class="url-btn get-url" href="#">Get Url</a>     <% if (model.url) { %>          <input class="url" value="<%= model.url %>"></input>         <div class="share-btn">Share Me</div>     <% } %> ',G=function(e){var t=function(e){l(this,t),_.defaults(e,{events:{"click .get-url":"upload"}}),B(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var n=this;n.listenTo(n.model,"change",function(){this.model.hasChanged("url")?n.render():(n.render(),n.hideLoading(),n.model.unset("url"))}),n.template=_.template(F)};return u(t,e),D(t,[{key:"postRender",value:function(){var e=this.model.get("url");e&&(this.$(".url").get(0).select(),this.$(".url-btn").addClass("hide"),this.showShare(e)),this.hideLoading()}},{key:"render",value:function(){var e=this.$(".sharer"),t={model:this.model.attributes};e.html(""),e.html(this.template(t)),this.postRender()}},{key:"showShare",value:function(e){this.$(".share-btn").hideshare({link:e,media:e+".gif",position:"bottom",linkedin:!1})}},{key:"showLoading",value:function(){$(".spinner").removeClass("hide"),this.$(".url-btn").addClass("hide")}},{key:"hideLoading",value:function(){$(".spinner").addClass("hide")}},{key:"upload",value:function(){this.showLoading();var e=this,t="Client-ID f0972432933fc36";$.ajax({url:"https://api.imgur.com/3/image",type:"POST",headers:{Authorization:t,Accept:"application/json"},data:{image:localStorage.dataBase64,type:"base64"},success:function(t){var n=t.data.id;e.model.set("url","https://i.imgur.com/"+n+".gif"),console.log("image upload with this id",n)},error:function(e){console.log(e)}})}}]),t}(V),H=G,I=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),L=function(e,t,n){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:app__get(r,t,n)}if("value"in o)return o.value;var i=o.get;return void 0===i?void 0:i.call(n)},A=Backbone,R=A.View,q=function(e){function t(e){s(this,t),L(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var n=new v;this.slateConfigView=new x({model:n,el:$(".slate__config")}),this.slateView=new S({model:n,el:$(".slate__preview")}),this.shareView=new H({model:n,el:$(".share-box")})}return c(t,e),I(t,[{key:"render",value:function(){this.slateConfigView.render(),this.slateView.render()}}]),t}(R);(new q).render()});
