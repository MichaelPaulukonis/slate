!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("config/share")):"function"==typeof define&&define.amd?define(["config/share"],t):t(e.config)}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=Backbone,d=h.Model,p=function(e){var r=function(){t(this,r),null!=e&&e.apply(this,arguments)};return n(r,e),f(r,[{key:"defaults",value:function(){return{bgColor:"#018790",textColor:"#fff",font:"Georgia, serif",text:"Generate your text here",width:400,height:400,fontHeight:50,delay:250}}}]),r}(d),v=p,g=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),y=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:SlateConfigView__get(o,t,n)}if("value"in r)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},b=Backbone,w=b.View,m=function(e){var t=function(e){r(this,t),_.defaults(e,{events:{"change .text-color":"setTextColor","change .bg-color":"setBgColor","keyup .height":"setFontHeight","keyup .text":"setText","keyup .delay":"setDelay"}}),y(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.$(".text-color").val(this.model.get("textColor")),this.$(".bg-color").val(this.model.get("bgColor"))};return o(t,e),g(t,[{key:"initialize",value:function(){this._setDebouncedText=_.debounce(_.bind(this.setDebouncedText,this),300)}},{key:"setDebouncedText",value:function(e){this.model.set({text:e})}},{key:"setDelay",value:function(e){this.model.set({delay:parseInt($(e.target).val(),10)})}},{key:"setText",value:function(e){var t=$(e.target).val();this._setDebouncedText(t)}},{key:"setFontHeight",value:function(e){this.model.set({fontHeight:parseInt($(e.target).val(),10)})}},{key:"setTextColor",value:function(e){this.model.set({textColor:"#"+$(e.target).val()})}},{key:"setBgColor",value:function(e){this.model.set({bgColor:"#"+$(e.target).val()})}},{key:"setAttributes",value:function(e){var t=$('[name="text"]').val();this.model.set({text:t})}}]),t}(w),x=m,k={setFont:function(e){var t=this.fontHeight*this.scale+"px";e.font=t+"/"+t+" "+this.font},createDummy:function(){var e=document.createElement("canvas");return e.width=this.width*this.scale,e.height=this.height*this.scale,e.getContext("2d")},drawBackground:function(e){var t=e.canvas.width,n=e.canvas.height;e.fillStyle=this.bgColor,e.fillRect(0,0,t,n)},drawText:function(e,t){var n=e.canvas.width/2,r=e.canvas.height/2;e.textAlign="center",e.textBaseline="middle",e.fillStyle=this.textColor,e.fillText(t,n,r)},drawDummy:function(e,t){var n=e.canvas.width,r=e.canvas.height;e.drawImage(t.canvas,0,0,n,r)},getCanvas:function(e){var t=document.createElement("canvas");return t.width=this.width,t.height=this.height,t},setProperties:function(e){this.bgColor=e.bgColor,this.height=e.height,this.width=e.width,this.text=e.text||"",this.textColor=e.textColor,this.delay=e.delay||350,this.fontHeight=e.fontHeight||40,this.font=e.font||"Georgia, serif",this.scale=2},render:function(e){var t=this,n=t.getCanvas().getContext("2d"),r=t.createDummy(),o=t.getGifCreator(e);t.setFont(r);for(var i=this.text.trim().split(" "),a=0,l=i.length;l>a;a++)t.drawBackground(r),t.drawText(r,i[a]),t.drawDummy(n,r),o.addFrame(n,{copy:!0,delay:t.delay});t.drawBackground(r),t.drawDummy(n,r),o.addFrame(n,{copy:!0,delay:2*t.delay}),o.render()},getGifCreator:function(e){var t=this,n=new GIF({workers:2,quality:10,width:t.width,height:t.height});return n.on("finished",function(t,n){var r=btoa(String.fromCharCode.apply(null,n));e(null,r)}),n}},O=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),C=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:SlateView__get(o,t,n)}if("value"in r)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},j=Backbone,T=j.View,P=function(e){var t=function(e){i(this,t),C(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.listenTo(this.model,"change",this.render)};return a(t,e),O(t,[{key:"render",value:function(){k.setProperties(this.model.toJSON()),k.render(function(e,t){var n=document.getElementById("result");n.src="data:image/gif;base64,"+t,localStorage.dataBase64=t})}}]),t}(T),S=P,D=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),B=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:ShareView__get(o,t,n)}if("value"in r)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},E=Backbone,V=E.View,F='     <input class="url" value="<%= url %>"></input>     <div class="share-btn">Share Me</div> ',H=function(e){var t=function(e){l(this,t),_.defaults(e,{events:{"click .get-url":"upload"}}),B(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var n=this;n.listenTo(n.model,"change",function(){n.model.hasChanged("url")?n.render():n.$(".sharer").html("")}),n.template=_.template(F)};return u(t,e),D(t,[{key:"postRender",value:function(){this.$(".url").get(0).select(),this.showShare()}},{key:"render",value:function(){this.$(".sharer").html(this.template(this.model.attributes)),this.postRender()}},{key:"showShare",value:function(){this.$(".share-btn").hideshare({link:"http://natearnold.me/hideshare/example",media:"http://farm7.staticflickr.com/6213/6243090894_8b8dd862cd.jpg",position:"bottom",linkedin:!1})}},{key:"showLoading",value:function(){}},{key:"hideLoading",value:function(){}},{key:"upload",value:function(){this.model.set("url",Math.random(10))}}]),t}(V),G=H,I=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),M=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:app__get(o,t,n)}if("value"in r)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},R=Backbone,q=R.View,A=function(e){function t(e){c(this,t),M(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var n=new v;this.slateConfigView=new x({model:n,el:$(".slate__config")}),this.slateView=new S({model:n,el:$(".slate__preview")}),this.shareView=new G({model:n,el:$(".share-box")})}return s(t,e),I(t,[{key:"render",value:function(){this.slateConfigView.render(),this.slateView.render()}}]),t}(q);(new A).render()});
